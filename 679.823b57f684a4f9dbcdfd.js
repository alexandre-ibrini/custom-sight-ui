"use strict";(self.webpackChunkros_fe_poc=self.webpackChunkros_fe_poc||[]).push([[679],{86679:(se,g,l)=>{l.r(g),l.d(g,{QueueTabModule:()=>_});var M=l(38583),v=l(95987),S=l(19083),o=l(37716),p=l(23065);const Q=(0,p.PH)("[Missions] Update Mission Steps",(0,p.Ky)());var y=l(23815);const B=(0,p.Lq)({loading:!1,steps:[]},(0,p.on)(Q,(s,u)=>{let e=(0,y.cloneDeep)(s);return e.steps=u.steps,e})),T=(0,p.Tz)({name:"missionSteps",reducer:B}),G=(0,p.P1)(T.selectSteps,s=>s),C=(0,p.PH)("[Missions] Update Mission Queue",(0,p.Ky)()),N=(0,p.Lq)({loading:!1,queue:[]},(0,p.on)(C,(s,u)=>{let e=(0,y.cloneDeep)(s);return e.queue=u.queue,e})),D=(0,p.Tz)({name:"missionQueue",reducer:N}),V=(0,p.P1)(D.selectQueue,s=>s);class R{static fromSopToArrayMissionSteps(u){let e=[],t=[];return u.d.forEach(i=>{let n=i;for(;"sop"===n.t;)n=n.d[0];t.push(n)}),t.forEach((i,n)=>{0!==n&&e.push({id:i.l[0],stepName:i.l[1],payload:i.l[2],userData:i.l[3]})}),e}}class A{static fromSopToArrayMissionQueue(u){let e=[],t=[];return u.d.forEach(i=>{let n=i;for(;"sop"===n.t;)n=n.d[0];t.push(n)}),t.forEach((i,n)=>{0!==n&&e.push({order:i.l[0],id:i.l[1],stepCount:i.l[2]})}),e}}var H=l(93898),P=l(70992);let q=(()=>{class s{constructor(e,t,i){this.store=e,this.channelsMW=t,this.responseMS=i,this.responseMS.missionSteps.subscribe(n=>{n&&this.receiveMissionSteps(n)}),this.responseMS.missionQueue.subscribe(n=>{n&&this.receiveMissionQueue(n)})}get missionSteps(){return this.store.select(G)}get missionQueue(){return this.store.select(V)}receiveMissionSteps(e){let t=R.fromSopToArrayMissionSteps(e);this.store.dispatch(Q({steps:t}))}receiveMissionQueue(e){let t=A.fromSopToArrayMissionQueue(e);this.store.dispatch(C({queue:t}))}toggleMissionSteps(e){this.channelsMW.toggleChannel("MissionSteps",e)}toggleMissionQueue(e){this.channelsMW.toggleChannel("MissionQueue",e)}}return s.\u0275fac=function(e){return new(e||s)(o.LFG(p.yh),o.LFG(H.$),o.LFG(P.B))},s.\u0275prov=o.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var E=l(77093),b=l(6040),x=l(65424);const z=["missionStepsTable"];let I=(()=>{class s{constructor(){this.tableData=[],this.columnsMissionSteps=[{id:"payload",name:"queue.missionSteps.columns.payload.name",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>this.getObjectKeyValuePairs(e),badgeBackgroundColorRule:e=>"transparent"}},{id:"stepName",name:"queue.missionSteps.columns.stepName.name",tooltip:"queue.missionSteps.columns.stepName.tooltip",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>e,badgeBackgroundColorRule:e=>"transparent"}},{id:"userData",name:"queue.missionSteps.columns.userData.name",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>this.getObjectKeyValuePairs(e),badgeBackgroundColorRule:e=>"transparent"}},{id:"id",name:"queue.missionSteps.columns.id.name",tooltip:"queue.missionSteps.columns.id.tooltip"}],this.getDisplayType=e=>"number"==typeof e?"number":"text"}ngOnInit(){}getObjectKeyValuePairs(e){let t=[],i=null;return e&&(i=JSON.parse(e)),i&&(t=this.getChildrenRecursive(i)),t}getChildrenRecursive(e,t){var i;let a,n=[],d=1;t?n=t.split("."):a="1";let r=this.getObjectKeys(e);if((null==r?void 0:r.length)<=0)return[];let h,m=[];for(let c of r){a=null==n?void 0:n.concat(d.toString()).join(".");let f=(null===(i=this.getObjectKeys(e[c]))||void 0===i?void 0:i.length)>0&&"string"!=typeof e[c],ee=f&&Array.isArray(e[c]);h={id:a,parentId:t,name:c,children:f?this.getChildrenRecursive(e[c],a):null,value:f?null:e[c],isArray:ee,displayType:f?null:this.getDisplayType(e[c])},m.push(h),d++}return m}getObjectKeys(e){if(e){let t=[];for(const i in e)t.push(i);return t}}ngOnDestroy(){}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=o.Xpm({type:s,selectors:[["app-mission-steps-table"]],viewQuery:function(e,t){if(1&e&&o.Gf(z,5),2&e){let i;o.iGM(i=o.CRH())&&(t.missionStepsTable=i.first)}},features:[o._Bn([{provide:b.Hn,useValue:{scope:"modules/pages/system-panel/queue",alias:"queue"}}])],decls:2,vars:5,consts:[[3,"titleText","columns","ELEMENT_DATA","areColumnsExpandable","tooltipText"],["missionStepsTable",""]],template:function(e,t){1&e&&o._UZ(0,"app-data-table",0,1),2&e&&o.Q6J("titleText","queue.missionSteps.title")("columns",t.columnsMissionSteps)("ELEMENT_DATA",t.tableData)("areColumnsExpandable",!1)("tooltipText","queue.missionSteps.tooltip")},directives:[x.Q],styles:[""]}),s})();const J=["missionQueueTable"];let U=(()=>{class s{constructor(){this.tableData=[],this.columnsMissionQueue=[{id:"order",name:"queue.missionQueue.columns.order.name",tooltip:"queue.missionQueue.columns.order.tooltip",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>e,badgeBackgroundColorRule:e=>"transparent"}},{id:"stepCount",name:"queue.missionQueue.columns.stepCount.name",tooltip:"queue.missionQueue.columns.stepCount.tooltip",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>e,badgeBackgroundColorRule:e=>"transparent"}},{id:"id",name:"queue.missionQueue.columns.id.name",tooltip:"queue.missionQueue.columns.id.tooltip"}]}ngOnInit(){}ngOnDestroy(){}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=o.Xpm({type:s,selectors:[["app-mission-queue-table"]],viewQuery:function(e,t){if(1&e&&o.Gf(J,5),2&e){let i;o.iGM(i=o.CRH())&&(t.missionQueueTable=i.first)}},features:[o._Bn([{provide:b.Hn,useValue:{scope:"modules/pages/system-panel/queue",alias:"queue"}}])],decls:2,vars:4,consts:[[3,"titleText","columns","ELEMENT_DATA","tooltipText"],["missionQueueTable",""]],template:function(e,t){1&e&&o._UZ(0,"app-data-table",0,1),2&e&&o.Q6J("titleText","queue.missionQueue.title")("columns",t.columnsMissionQueue)("ELEMENT_DATA",t.tableData)("tooltipText","queue.missionQueue.tooltip")},directives:[x.Q],styles:[""]}),s})();const Z=["missionQueue"],j=["missionSteps"],w=[{path:"",component:(()=>{class s{constructor(e){this.missionMS=e,this.subscriptions=[]}ngOnInit(){this.missionMS.toggleMissionQueue(!0),this.missionMS.toggleMissionSteps(!0)}ngAfterViewInit(){this.subscriptions.push(this.missionMS.missionQueue.subscribe(e=>{var t,i,n,a,d;let r=e.map((m,h)=>({id:m.id,order:m.order,stepCount:m.stepCount}));(0,S.diff)(null===(t=this.missionQueue)||void 0===t?void 0:t.tableData,r)&&((null===(i=this.missionQueue)||void 0===i?void 0:i.tableData)&&(this.missionQueue.tableData=r),null===(a=null===(n=this.missionQueue)||void 0===n?void 0:n.missionQueueTable)||void 0===a||a.setTableData(null===(d=this.missionQueue)||void 0===d?void 0:d.tableData))}),this.missionMS.missionSteps.subscribe(e=>{var t,i,n,a;let d=e.map((r,m)=>({id:r.id,payload:r.payload,stepName:r.stepName,userData:r.userData}));(0,S.diff)(null===(t=this.missionSteps)||void 0===t?void 0:t.tableData,d)&&(this.missionSteps&&(this.missionSteps.tableData=d),null===(n=null===(i=this.missionSteps)||void 0===i?void 0:i.missionStepsTable)||void 0===n||n.setTableData(null===(a=this.missionSteps)||void 0===a?void 0:a.tableData))}))}ngOnDestroy(){this.missionMS.toggleMissionSteps(!1),this.missionMS.toggleMissionQueue(!1),this.subscriptions.forEach(e=>e.unsubscribe())}}return s.\u0275fac=function(e){return new(e||s)(o.Y36(q))},s.\u0275cmp=o.Xpm({type:s,selectors:[["app-queue-tab"]],viewQuery:function(e,t){if(1&e&&(o.Gf(Z,5),o.Gf(j,5)),2&e){let i;o.iGM(i=o.CRH())&&(t.missionQueue=i.first),o.iGM(i=o.CRH())&&(t.missionSteps=i.first)}},decls:5,vars:0,consts:[["fxLayout","column","fxLayoutGap","16px",1,"outer-div-padding",2,"height","100%","color","black","overflow","auto"],["missionSteps",""],["missionQueue",""]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"app-mission-steps-table",null,1),o._UZ(3,"app-mission-queue-table",null,2),o.qZA())},directives:[E.xw,E.SQ,I,U],styles:[""]}),s})()},{path:"**",redirectTo:""}];let W=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=o.oAB({type:s}),s.\u0275inj=o.cJS({imports:[[v.Bz.forChild(w)],v.Bz]}),s})();var X=l(69904),Y=l(22685),$=l(27909);let k=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=o.oAB({type:s}),s.\u0275inj=o.cJS({providers:[R,A,q],imports:[[M.ez,p.Aw.forFeature(T),p.Aw.forFeature(D)]]}),s})(),_=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=o.oAB({type:s}),s.\u0275inj=o.cJS({imports:[[M.ez,W,X.A,Y.t,$.o9,k,b.y4]]}),s})()}}]);