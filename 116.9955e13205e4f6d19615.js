"use strict";(self.webpackChunkros_fe_poc=self.webpackChunkros_fe_poc||[]).push([[116],{5116:(oe,y,l)=>{l.r(y),l.d(y,{NetworkingModule:()=>ie});var v=l(8583),x=l(6983),c=l(3679),h=l(9083),g=l(3815);const M={"Device Identity":{fields:[{displayName:"Hostname",fieldName:"hostname",placeholder:"Add your host",fieldState:"",type:"String",validators:[],disabled:!0}]},Interfaces:{fields:[{displayName:"Hostname",fieldName:"hostname",placeholder:"Add your host",type:"String",fieldState:"",validators:[],disabled:!0},{displayName:"IP address",fieldName:"ipAddress",placeholder:"Add your Ip address",type:"String",fieldState:"",validators:[],disabled:!0},{displayName:"Mask",fieldName:"mask",placeholder:"Add your mask",type:"String",fieldState:"",validators:[],disabled:!0},{displayName:"Gateway",fieldName:"gateway",placeholder:"Add your gateway",type:"String",fieldState:"",validators:[],disabled:!0},{displayName:"Interfaces",fieldName:"interfaces",placeholder:"",fieldState:"",type:"Select",options:[],display:"inline",validators:[]}]}};var e=l(7716),a=l(3065);const w=(0,a.PH)("[Interfaces] Update Interfaces",(0,a.Ky)()),U=(0,a.Lq)({loading:!1,interfaces:void 0},(0,a.on)(w,(n,o)=>Object.assign(Object.assign({},n),{interfaces:o.interfaces}))),N=(0,a.Tz)({name:"interfaces",reducer:U}),G=(0,a.P1)(N.selectInterfaces,n=>n);var Z=l(2340),I=l(1841);let C=(()=>{class n{constructor(t){this.http=t,this.baseUrl=Z.N.OnboardingApiEndpoint,this.getInterfacesUrl=this.baseUrl+"interface"}getInterfaces(){return this.http.get(this.getInterfacesUrl)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(I.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),S=(()=>{class n{constructor(t,i){this.store=t,this.interfaceApiService=i}get interfaces(){return this.store.select(G)}getInterfaceByName(t){return this.store.select((n=>(0,a.P1)(N.selectInterfaces,o=>null==o?void 0:o.find(t=>t.name===n)))(t))}fetchInterfaces(){this.interfaceApiService.getInterfaces().subscribe(t=>{this.setInterfaces(t)})}setInterfaces(t){this.store.dispatch(w({interfaces:t}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(a.yh),e.LFG(C))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const A=(0,a.PH)("[Provisioning] Update Provisioning",(0,a.Ky)()),Q=(0,a.Lq)({loading:!1,provisioning:void 0},(0,a.on)(A,(n,o)=>Object.assign(Object.assign({},n),{provisioning:o.provisioning}))),m=(0,a.Tz)({name:"provisioning",reducer:Q}),H=(0,a.P1)(m.selectProvisioning,n=>n),Y=(0,a.P1)(m.selectProvisioning,n=>{var o;return null===(o=null==n?void 0:n.name_servers)||void 0===o?void 0:o.ips}),z=(0,a.P1)(m.selectProvisioning,n=>{var o;return null===(o=null==n?void 0:n.ntp)||void 0===o?void 0:o.ips});let P=(()=>{class n{constructor(t){this.http=t,this.baseUrl=Z.N.OnboardingApiEndpoint,this.getAndPostAllProvisioningUrl=this.baseUrl+"provisioning",this.PostProvisioningNtpUrl=this.baseUrl+"provisioning/ntp",this.PostProvisioningDnsUrl=this.baseUrl+"provisioning/dns",this.PostProvisioningHostnameUrl=this.baseUrl+"provisioning/hostname"}getAllProvisioning(){return this.http.get(this.getAndPostAllProvisioningUrl)}postAllProvisioning(t){return this.http.post(this.getAndPostAllProvisioningUrl,t)}postProvisioningNtp(t){return this.http.post(this.PostProvisioningNtpUrl,t)}postProvisioningDns(t){return this.http.post(this.PostProvisioningDnsUrl,t)}postProvisioningHostName(t){return this.http.post(this.PostProvisioningHostnameUrl,{hostname:t})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(I.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),T=(()=>{class n{constructor(t,i){this.store=t,this.provisioningApiService=i}get provisioning(){return this.store.select(H)}get nameServerIps(){return this.store.select(Y)}get ntpIps(){return this.store.select(z)}setProvisioning(t){this.store.dispatch(A({provisioning:t}))}fetchProvisioning(){this.provisioningApiService.getAllProvisioning().subscribe(t=>{this.setProvisioning(t)})}sendProvisioning(t){return this.provisioningApiService.postAllProvisioning(t)}sendProvisioningNtp(t){return this.provisioningApiService.postProvisioningNtp(t)}sendProvisioningDns(t){return this.provisioningApiService.postProvisioningDns(t)}sendProvisioningHostname(t){return this.provisioningApiService.postProvisioningHostName(t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(a.yh),e.LFG(P))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=l(7093),k=l(1769),_=l(8295),F=l(9983),b=l(7441),E=l(2458),O=l(1095);function j(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",26),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function $(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-select",25),e.NdJ("valueChange",function(r){const p=e.CHM(t).$implicit,d=e.oxw().$implicit,u=e.oxw();return p.onSelectChange(r,d.value,u.interfaces,u.networkingFormGoup)}),e.YNc(2,j,3,2,"ng-container",23),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw().$implicit,r=e.oxw();e.xp6(1),e.Q6J("value",r.getSelectedOptionValue(i.key,t.fieldName)),e.xp6(1),e.Q6J("ngForOf",t.options)}}function B(n,o){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"mat-form-field",27),e.TgZ(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"input",28),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(t.displayName),e.xp6(1),e.Q6J("formControlName",t.fieldName)("type",i.getControlType(t))("placeholder",t.placeholder)}}function R(n,o){if(1&n&&(e.TgZ(0,"div",20),e.TgZ(1,"div",6),e.TgZ(2,"div",21),e.TgZ(3,"span",7),e._uU(4),e.qZA(),e.TgZ(5,"form",22),e.YNc(6,$,3,2,"mat-form-field",23),e.qZA(),e.qZA(),e._UZ(7,"mat-divider",8),e.qZA(),e.TgZ(8,"form",24),e.YNc(9,B,5,4,"div",23),e.qZA(),e.qZA()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(4),e.Oqu(t.key),e.xp6(1),e.Q6J("formGroupName",t.key),e.xp6(1),e.Q6J("ngForOf",i.getInlineSelectControls(t.value)),e.xp6(2),e.Q6J("formGroupName",t.key),e.xp6(1),e.Q6J("ngForOf",i.getInputFields(t.value))}}function K(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"i",29),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw().deleteNTP(s)}),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function X(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"i",29),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw().deleteDNS(s)}),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function W(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",30),e.TgZ(1,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveChanges()}),e._uU(2,"Save Changes"),e.qZA(),e.TgZ(3,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().cancelChanges()}),e._uU(4," Cancel Changes"),e.qZA(),e.qZA()}}const ee=[{path:"",component:(()=>{class n{constructor(t,i){this.interfacesMS=t,this.provisioningMS=i,this.networkingFormGoup=new c.cw({}),this.networkingFormFields=(0,g.cloneDeep)(M),this.nameServerIps=[],this.dnsValue="",this.ntpIps=[],this.ntpValue="",this.subscriptions=[],this.interfaces=[],this.showSaveOrCancel=!1}ngOnInit(){Object.keys(this.networkingFormFields).forEach(t=>{var i,r,s;this.networkingFormFields.Interfaces.fields.find(d=>"interfaces"===d.fieldName).onSelectChange=this.setInterfaceFormFromName;let p=new c.cw({});null===(s=null===(r=null===(i=this.networkingFormFields)||void 0===i?void 0:i[t])||void 0===r?void 0:r.fields)||void 0===s||s.forEach(d=>{p.addControl(d.fieldName,new c.NI({value:"",disabled:d.disabled},d.validators))}),this.networkingFormGoup.addControl(t,p)}),this.interfacesMS.fetchInterfaces(),this.provisioningMS.fetchProvisioning(),this.subscriptions.push(this.provisioningMS.nameServerIps.subscribe(t=>{let i=(0,g.cloneDeep)(t);i&&(0,h.diff)(i,this.nameServerIps)&&(console.log(i),this.nameServerIps=i,this.tempNameServerIps=(0,g.cloneDeep)(i))}),this.provisioningMS.ntpIps.subscribe(t=>{let i=(0,g.cloneDeep)(t);i&&(0,h.diff)(i,this.ntpIps)&&(this.ntpIps=i,this.tempNtpIps=(0,g.cloneDeep)(i))}),this.provisioningMS.provisioning.subscribe(t=>{var i,r,s,p;t&&(null===(r=null===(i=this.networkingFormGoup)||void 0===i?void 0:i.controls)||void 0===r||r["Device Identity"].setValue({hostname:(null===(s=null==t?void 0:t.hostname)||void 0===s?void 0:s.hostname)?null===(p=null==t?void 0:t.hostname)||void 0===p?void 0:p.hostname:""}))}),this.interfacesMS.interfaces.subscribe(t=>{var i,r;t&&((0,h.diff)(this.interfaces,t)&&(this.interfaces=t),this.networkingFormFields.Interfaces.fields.find(s=>"interfaces"===s.fieldName).options=t.map(s=>s.name),(null===(r=null===(i=this.networkingFormGoup.get("Interfaces"))||void 0===i?void 0:i.get("interfaces"))||void 0===r?void 0:r.value)||(this.networkingFormGoup.get("Interfaces").get("interfaces").setValue(t),this.setInterfaceFormFromName("eth0",this.networkingFormFields.Interfaces,t,this.networkingFormGoup)))}))}getInterfaceFromName(t){var i;console.log(t);let r=this.interfaces.find(s=>s.name===t);return r||(r=null===(i=this.interfaces)||void 0===i?void 0:i[0]),r}getSelectedOptionValue(t,i){return this.networkingFormFields[t].fields.find(r=>r.fieldName===i).selectOptionValue}setInterfaceFormFromName(t,i,r,s){var p;console.log(t),i.fields.find(u=>"interfaces"===u.fieldName).selectOptionValue=t;let d=null==r?void 0:r.find(u=>u.name===t);console.log(r,d),d||(d=null==r?void 0:r[0]),null===(p=s.get("Interfaces"))||void 0===p||p.patchValue({hostname:d.name,mask:"222.222.222.0",ipAddress:d.ipv4,gateway:d.gateway})}getInlineSelectControls(t){return t.fields.filter(i=>"Select"===i.type&&"inline"===i.display)}getInputFields(t){return t.fields.filter(i=>"Select"!==i.type)}getControlType(t){let i="";switch(t.type.toLowerCase()){case"number":i="number";break;case"string":case"stringtolist":i="text";break;case"date":i="datetime-local";break;case"select":i="select";break;case"file":i="file";break;default:i="text"}return i}showSaveOrCancelChanges(t=!0){this.showSaveOrCancel=t}addDNS(){console.log(this.dnsValue),this.nameServerIps.push(this.dnsValue),this.dnsValue="",this.showSaveOrCancelChanges()}deleteDNS(t){console.log(t,this.nameServerIps),this.nameServerIps.splice(t,1),this.showSaveOrCancelChanges()}addNTP(){this.ntpIps.push(this.ntpValue),this.ntpValue="",this.showSaveOrCancelChanges()}deleteNTP(t){this.ntpIps.splice(t,1),this.showSaveOrCancelChanges()}saveChanges(){this.provisioningMS.sendProvisioningDns(this.nameServerIps).subscribe(()=>{this.tempNameServerIps=(0,g.cloneDeep)(this.nameServerIps),this.provisioningMS.sendProvisioningNtp(this.ntpIps).subscribe(()=>{this.tempNtpIps=(0,g.cloneDeep)(this.ntpIps),this.showSaveOrCancelChanges(!1)})})}cancelChanges(){this.nameServerIps=(0,g.cloneDeep)(this.tempNameServerIps),this.ntpIps=(0,g.cloneDeep)(this.tempNtpIps),this.showSaveOrCancelChanges(!1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(S),e.Y36(T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-networking"]],decls:36,vars:11,consts:[[1,"outer-div-padding"],["fxLayout","column","fxLayoutGap","32px",1,"page-components"],["fxLayout","column","fxLayoutGap","16px",3,"formGroup"],["fxLayout","column","fxLayoutGap","16px",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutGap","32px",1,"width100"],["fxLayout","column","fxLayoutGap","16px","fxFlex","49"],["fxLayout","column","fxLayoutGap","8px"],[1,"groupTitle"],["horizontal",""],["fxLayout","row wrap","fxLayoutGap","16px"],["appearance","outline","color","accent","fxFlex",""],["matInput","","type","text",3,"ngModel","placeholder","ngModelChange","keyup.enter"],["fxLayoutAlign","center center","fxFlex","10"],[1,"bi","bi-plus-circle","addIcon",3,"click"],[1,"itemsListOuterDiv"],["fxLayout","row","fxLayoutAlign","space-between center",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutGap","8px",1,"width100"],["fxLayout","row wrap","fxLayoutGap","16px",1,"width100"],["fxLayout","row","fxLayoutAlign","end center",2,"margin-top","32px"],["fxLayout","row","fxLayoutGap","16px",4,"ngIf"],["fxLayout","column","fxLayoutGap","16px"],["fxLayout","row","fxLayoutAlign","space-between center"],[3,"formGroupName"],[4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayoutGap","16px",3,"formGroupName"],[3,"value","valueChange"],[3,"value"],["appearance","outline","color","accent"],["matInput","",3,"formControlName","type","placeholder"],[1,"bi","bi-trash","deleteIcon",3,"click"],["fxLayout","row","fxLayoutGap","16px"],["mat-flat-button","","color","accent",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"form",2),e.YNc(3,R,10,5,"div",3),e.ALo(4,"keyvalue"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"span",7),e._uU(9,"NTP configuration"),e.qZA(),e._UZ(10,"mat-divider",8),e.qZA(),e.TgZ(11,"div",9),e.TgZ(12,"mat-form-field",10),e.TgZ(13,"mat-label"),e._uU(14,"New NTP"),e.qZA(),e.TgZ(15,"input",11),e.NdJ("ngModelChange",function(s){return i.ntpValue=s})("keyup.enter",function(){return i.addNTP()}),e.qZA(),e.qZA(),e.TgZ(16,"div",12),e.TgZ(17,"i",13),e.NdJ("click",function(){return i.addNTP()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"div",14),e.YNc(19,K,4,1,"div",15),e.qZA(),e.qZA(),e.TgZ(20,"div",5),e.TgZ(21,"div",16),e.TgZ(22,"span",7),e._uU(23,"DNS configuration"),e.qZA(),e._UZ(24,"mat-divider",8),e.qZA(),e.TgZ(25,"div",17),e.TgZ(26,"mat-form-field",10),e.TgZ(27,"mat-label"),e._uU(28,"new DNS "),e.qZA(),e.TgZ(29,"input",11),e.NdJ("ngModelChange",function(s){return i.dnsValue=s})("keyup.enter",function(){return i.addDNS()}),e.qZA(),e.qZA(),e.TgZ(30,"div",12),e.TgZ(31,"i",13),e.NdJ("click",function(){return i.addDNS()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",14),e.YNc(33,X,4,1,"div",15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(34,"div",18),e.YNc(35,W,5,0,"div",19),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.networkingFormGoup),e.xp6(1),e.Q6J("ngForOf",e.lcZ(4,9,i.networkingFormFields)),e.xp6(12),e.Q6J("ngModel",i.ntpValue)("placeholder","eg. 8.8.8.8"),e.xp6(4),e.Q6J("ngForOf",i.ntpIps),e.xp6(10),e.Q6J("ngModel",i.dnsValue)("placeholder","eg. 8.8.8.8"),e.xp6(4),e.Q6J("ngForOf",i.nameServerIps),e.xp6(2),e.Q6J("ngIf",i.showSaveOrCancel))},directives:[f.xw,f.SQ,c._Y,c.JL,c.sg,v.sg,f.yH,k.d,_.KE,_.hX,F.Nt,c.Fj,c.JJ,c.On,f.Wh,v.O5,c.F,c.x0,b.gD,E.ey,c.u,O.lW],pipes:[v.Nd],styles:[".groupTitle[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.itemsListOuterDiv[_ngcontent-%COMP%]{padding:0 32px}.itemsListOuterDiv[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:5px;border-radius:5px}.itemsListOuterDiv[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:hover{background-color:var(--grey-color)}.width100[_ngcontent-%COMP%]{width:100%}.addIcon[_ngcontent-%COMP%]:hover{color:var(--accent-color)}.addIcon[_ngcontent-%COMP%]{cursor:pointer}.deleteIcon[_ngcontent-%COMP%]{cursor:pointer}.deleteIcon[_ngcontent-%COMP%]:hover{color:var(--error-color)}"]}),n})()},{path:"**",redirectTo:""}];let te=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[x.Bz.forChild(ee)],x.Bz]}),n})(),ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[P,S,T,C],imports:[[v.ez,a.Aw.forFeature(m),a.Aw.forFeature(N)]]}),n})(),ie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[v.ez,te,ne,c.UX,c.u5,f.ae,_.lN,F.c,O.ot,b.LD,k.t]]}),n})()}}]);