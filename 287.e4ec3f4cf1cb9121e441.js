"use strict";(self.webpackChunkros_fe_poc=self.webpackChunkros_fe_poc||[]).push([[287],{97287:(dt,m,r)=>{r.r(m),r.d(m,{EthercatTabModule:()=>nt});var u=r(38583),v=r(95987),x=r(2938),C=r(19083),A=r(6040),t=r(37716),d=r(23065);const _=(0,d.PH)("[Ethercat] Update Ethercat",(0,d.Ky)()),T=(0,d.PH)("[Ethercat] Update CRC Count",(0,d.Ky)()),M=(0,d.Lq)({loading:!1,nodes:[],crcCount:0},(0,d.on)(_,(e,n)=>Object.assign(Object.assign({},e),{nodes:n.nodes})),(0,d.on)(T,(e,n)=>Object.assign(Object.assign({},e),{crcCount:n.crcCount}))),h=(0,d.Tz)({name:"ethercatLogs",reducer:M}),F=(0,d.P1)(h.selectNodes,e=>e),w=(0,d.P1)(h.selectCrcCount,e=>e);class Z{static fromSopToCrcCount(n){let c,i=0,o=[];return n.d.forEach(s=>{let p=s;for(;"sop"===p.t;)p=p.d[0];o.push(p)}),c=o[0].l.findIndex(s=>"Count"===s),o.forEach((s,p)=>{"CRC Errors"===s.l[0]&&(i=s.l[c])}),i}static fromSopToEthercatNodes(n){var i;let o=[],c=[];n.d.splice(0,1),n.d.splice(4,1);let p=[];n.d.forEach(a=>{let f=a;for(;"sop"===f.t;)f=f.d[0];p.push(f)}),p.forEach((a,f)=>{c=[{title:"Sent",value:a.l[1]},{title:"Received",value:a.l[2]},{title:"Disconnections",value:a.l[3]}],o.push({title:a.l[0],isFaulty:!1,isDisconnected:a.l[4],description:{success:!0,data:c}})});for(let a=1;a<o.length;a++)o[a-1].isFaulty=!(null==o?void 0:o[a-1].isDisconnected)&&(null===(i=null==o?void 0:o[a])||void 0===i?void 0:i.isDisconnected);return o}}var E=r(70992),D=r(93898);let S=(()=>{class e{constructor(i,o,c){this.store=i,this.responseMS=o,this.channelsMS=c,this.responseMS.ethercat.subscribe(s=>{s&&this.receiveEthercatLogs(s)})}get ethercatNodes(){return this.store.select(F)}get ethercatCrcCount(){return this.store.select(w)}receiveEthercatLogs(i){let o=Z.fromSopToCrcCount(i),c=Z.fromSopToEthercatNodes(i);this.store.dispatch(_({nodes:c})),this.store.dispatch(T({crcCount:o}))}toggleEthercatChannel(i){this.channelsMS.toggleChannel("Ethercat",i)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(d.yh),t.LFG(E.B),t.LFG(D.$))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var O=r(58011),l=r(77093),g=r(93738);function I(e,n){1&e&&t._UZ(0,"div",8)}function J(e,n){if(1&e&&(t.TgZ(0,"div"),t.TgZ(1,"div",5),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span",6),t._uU(5),t.qZA(),t.qZA(),t.YNc(6,I,1,0,"div",7),t.qZA()),2&e){const i=n.$implicit,o=n.last;t.xp6(3),t.hij(" ",i.title," "),t.xp6(2),t.hij(" ",i.value," "),t.xp6(1),t.Q6J("ngIf",!o)}}function B(e,n){if(1&e&&(t.TgZ(0,"div",1),t._UZ(1,"div",2),t.TgZ(2,"div"),t.TgZ(3,"mat-card",3),t.TgZ(4,"mat-card-content"),t.YNc(5,J,7,3,"div",4),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){const i=t.oxw();t.xp6(5),t.Q6J("ngForOf",i.description.data)}}function Q(e,n){1&e&&t._UZ(0,"div",8)}function q(e,n){if(1&e&&(t.TgZ(0,"div"),t.TgZ(1,"div",5),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span",6),t._uU(5),t.qZA(),t.qZA(),t.YNc(6,Q,1,0,"div",7),t.qZA()),2&e){const i=n.$implicit,o=n.last;t.xp6(3),t.hij(" ",i.title," "),t.xp6(2),t.hij(" ",i.value," "),t.xp6(1),t.Q6J("ngIf",!o)}}function R(e,n){if(1&e&&(t.TgZ(0,"div",1),t.TgZ(1,"div"),t.TgZ(2,"mat-card",3),t.TgZ(3,"mat-card-content"),t.YNc(4,q,7,3,"div",4),t.qZA(),t.qZA(),t.qZA(),t._UZ(5,"div",9),t.qZA()),2&e){const i=t.oxw();t.xp6(4),t.Q6J("ngForOf",i.description.data)}}let P=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-description-node"]],inputs:{description:"description",isRight:"isRight"},decls:2,vars:2,consts:[["fxLayout","row","fxLayoutAlign","start center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center"],["fxFlexAlign","baseline",1,"arrow-left",2,"margin-top","10px"],[1,"card"],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","space-between start",1,"card-element","element-color"],[2,"padding-left","20px"],["class","border-bottom",4,"ngIf"],[1,"border-bottom"],["fxFlexAlign","baseline",1,"arrow-right",2,"margin-top","10px"]],template:function(i,o){1&i&&(t.YNc(0,B,6,1,"div",0),t.YNc(1,R,6,1,"div",0)),2&i&&(t.Q6J("ngIf",o.isRight),t.xp6(1),t.Q6J("ngIf",!o.isRight))},directives:[u.O5,l.xw,l.Wh,l.XD,g.a8,g.dn,u.sg],styles:[".card[_ngcontent-%COMP%]{border-radius:6px;width:300px;height:-moz-fit-content;height:fit-content;border:1px solid #EDF2F7}.element-color[_ngcontent-%COMP%]{color:#8492a6;font-size:14px}.arrow-left[_ngcontent-%COMP%]{width:0;height:0;border-top:15px solid transparent;border-bottom:15px solid transparent;border-right:15px solid #EBF2FA}.arrow-right[_ngcontent-%COMP%]{width:0;height:0;border-top:15px solid transparent;border-bottom:15px solid transparent;border-left:15px solid #EBF2FA}  mat-card{box-shadow:none!important}.mat-card[_ngcontent-%COMP%]{padding:5px 0}.card-element[_ngcontent-%COMP%]{padding:0 10px}.border-bottom[_ngcontent-%COMP%]{border-bottom:1px solid #EDF2F7}@media screen and (max-width: 650px){.card[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}}"]}),e})();var y=r(11436);function U(e,n){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"i",9),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("matTooltip",i.errorDescription)}}const N=function(e){return[e]};function Y(e,n){if(1&e&&t._UZ(0,"div",10),2&e){const i=t.oxw(2);t.Q6J("ngClass",t.VKq(1,N,i.node.isDisconnected||i.node.isFaulty?"line-failure":"line-success"))}}function z(e,n){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"i",11),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("matTooltip",i.errorDescription)}}function j(e,n){if(1&e&&(t.TgZ(0,"div",1),t._UZ(1,"div",2),t.TgZ(2,"div",3),t.TgZ(3,"div",4),t.TgZ(4,"span",5),t._uU(5),t.qZA(),t.YNc(6,U,2,1,"div",6),t.qZA(),t.TgZ(7,"div",4),t.YNc(8,Y,1,3,"div",7),t.YNc(9,z,2,1,"div",6),t.qZA(),t.qZA(),t.TgZ(10,"div"),t._UZ(11,"app-description-node",8),t.qZA(),t.qZA()),2&e){const i=t.oxw();t.xp6(5),t.Oqu(i.node.title),t.xp6(1),t.Q6J("ngIf",i.node.isFaulty&&i.mdScreen),t.xp6(2),t.Q6J("ngIf",!i.isLast),t.xp6(1),t.Q6J("ngIf",i.node.isFaulty&&!i.mdScreen),t.xp6(2),t.Q6J("isRight",i.isRight)("description",i.node.description)}}function W(e,n){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"i",11),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("matTooltip",i.errorDescription)}}function H(e,n){if(1&e&&t._UZ(0,"div",10),2&e){const i=t.oxw(2);t.Q6J("ngClass",t.VKq(1,N,i.node.isDisconnected||i.node.isFaulty?"line-failure":"line-success"))}}function V(e,n){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"i",11),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("matTooltip",i.errorDescription)}}function K(e,n){if(1&e&&(t.TgZ(0,"div",1),t.TgZ(1,"div"),t._UZ(2,"app-description-node",8),t.qZA(),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"span",5),t._uU(6),t.qZA(),t.YNc(7,W,2,1,"div",6),t.qZA(),t.TgZ(8,"div",4),t.YNc(9,H,1,3,"div",7),t.YNc(10,V,2,1,"div",6),t.qZA(),t.qZA(),t._UZ(11,"div",2),t.qZA()),2&e){const i=t.oxw();t.xp6(2),t.Q6J("isRight",i.isRight)("description",i.node.description),t.xp6(4),t.Oqu(i.node.title),t.xp6(1),t.Q6J("ngIf",i.node.isFaulty&&i.mdScreen),t.xp6(2),t.Q6J("ngIf",!i.isLast),t.xp6(1),t.Q6J("ngIf",i.node.isFaulty&&!i.mdScreen)}}let X=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-title-node"]],inputs:{node:"node",isRight:"isRight",isLast:"isLast",errorDescription:"errorDescription",mdScreen:"mdScreen"},decls:2,vars:2,consts:[["fxLayout","row","fxLayoutAlign","center start",4,"ngIf"],["fxLayout","row","fxLayoutAlign","center start"],[1,"hidden-div"],["fxLayout","column","fxLayoutAlign"," center",1,"title-div"],["fxLayout","row","fxLayoutAlign","center center"],[1,"title-style"],[4,"ngIf"],["class","dotted-line",3,"ngClass",4,"ngIf"],[3,"isRight","description"],[1,"bi","bi-exclamation-triangle-fill","icon-style",3,"matTooltip"],[1,"dotted-line",3,"ngClass"],[1,"bi","bi-exclamation-triangle-fill","icon-style","icon-position",3,"matTooltip"]],template:function(i,o){1&i&&(t.YNc(0,j,12,6,"div",0),t.YNc(1,K,12,6,"div",0)),2&i&&(t.Q6J("ngIf",o.isRight),t.xp6(1),t.Q6J("ngIf",!o.isRight))},directives:[u.O5,l.xw,l.Wh,P,y.gM,u.mk],styles:[".title-style[_ngcontent-%COMP%]{font-size:28px;font-weight:400;color:#425466}.title-div[_ngcontent-%COMP%]{width:200px;padding-top:10px}.dotted-line[_ngcontent-%COMP%]{height:60px;border-left:6px dotted;margin-top:5px}.line-success[_ngcontent-%COMP%]{border-left-color:var(--green-success)}.line-failure[_ngcontent-%COMP%]{border-left-color:var(--red-failure)}.icon-style[_ngcontent-%COMP%]{padding-left:10px;color:var(--red-failure)}.icon-position[_ngcontent-%COMP%]{position:absolute;right:46%}.hidden-div[_ngcontent-%COMP%]{width:316px;visibility:hidden}@media screen and (max-width: 1350px){.icon-position[_ngcontent-%COMP%]{position:absolute;right:45%}}@media screen and (max-width: 950px){.hidden-div[_ngcontent-%COMP%]{display:none}}@media screen and (max-width: 650px){.title-style[_ngcontent-%COMP%]{font-size:22px}.title-div[_ngcontent-%COMP%]{width:100px;text-align:center}}"]}),e})();function G(e,n){if(1&e&&(t.TgZ(0,"div",1),t._UZ(1,"app-title-node",2),t.qZA()),2&e){const i=n.$implicit,o=n.index,c=n.last,s=t.oxw();t.xp6(1),t.Q6J("node",i)("isLast",c)("isRight",o%2==0||s.mdScreen)("errorDescription",s.errorDescription)("mdScreen",s.mdScreen)}}let $=(()=>{class e{constructor(){this.nodesList=[]}ngOnInit(){this.checkWindowSize(window.innerWidth)}onResize(i){this.checkWindowSize(window.innerWidth)}checkWindowSize(i){this.mdScreen=i<=950}trackByName(i,o){return o.title}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-nodes-list"]],hostBindings:function(i,o){1&i&&t.NdJ("resize",function(s){return o.onResize(s)},!1,t.Jf7)},inputs:{nodesList:"nodesList",errorDescription:"errorDescription"},decls:1,vars:2,consts:[["fxLayout","column","fxLayoutAlign","center center",4,"ngFor","ngForOf","ngForTrackBy"],["fxLayout","column","fxLayoutAlign","center center"],[3,"node","isLast","isRight","errorDescription","mdScreen"]],template:function(i,o){1&i&&t.YNc(0,G,2,5,"div",0),2&i&&t.Q6J("ngForOf",o.nodesList)("ngForTrackBy",o.trackByName)},directives:[u.sg,l.xw,l.Wh,X],styles:[""]}),e})();const k=[{path:"",component:(()=>{class e{constructor(i,o){this.ethercatMS=i,this.notificationBarMS=o,this.subscriptions=[],this.nodesList=[],this.errorDescription=""}ngOnInit(){this.subscriptions.push(this.ethercatMS.ethercatNodes.subscribe(i=>{if(i&&(0,C.diff)(i,this.nodesList)){this.nodesList=i;let o=this.nodesList.findIndex(c=>c.isFaulty);(0,C.diff)(this.isFaultyIndex,o)&&(this.isFaultyIndex=o,this.isFaultyIndex>=0?this.notificationBarMS.addNotificationBar({id:"ethercatDisconnectionError",closable:!1,content:"notificationBar.ethercat.errorDescription",severity:x.l.FATAL,translationValue:[this.nodesList[this.isFaultyIndex].title,this.nodesList[this.isFaultyIndex+1].title]}):this.notificationBarMS.removeNotificationBar("ethercatDisconnectionError"))}}),this.ethercatMS.ethercatCrcCount.subscribe(i=>{void 0!==i&&this.notificationBarMS.addNotificationBar({id:"ethercatCrcCount",closable:!1,content:"notificationBar.ethercat.crcNotification",translationValue:[i],severity:x.l.WARNING})})),this.ethercatMS.toggleEthercatChannel(!0)}ngOnDestroy(){this.notificationBarMS.removeNotificationBar("ethercatCrcCount"),this.notificationBarMS.removeNotificationBar("ethercatDisconnectionError"),this.subscriptions.forEach(i=>i.unsubscribe()),this.ethercatMS.toggleEthercatChannel(!1)}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(S),t.Y36(O.Y))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-ethercat-tab"]],features:[t._Bn([{provide:A.Hn,useValue:{scope:"modules/pages/logging/ethercat",alias:"ethercat"}}])],decls:2,vars:2,consts:[["fxLayout","column","fxLayoutAlign","start center",2,"padding","30px 0 30px 0"],[3,"nodesList","errorDescription"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"app-nodes-list",1),t.qZA()),2&i&&(t.xp6(1),t.Q6J("nodesList",o.nodesList)("errorDescription",o.errorDescription))},directives:[l.xw,l.Wh,$],styles:[""]}),e})()},{path:"**",redirectTo:""}];let tt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[v.Bz.forChild(k)],v.Bz]}),e})();var et=r(69904);let it=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[e],imports:[[u.ez,d.Aw.forFeature(h)]]}),e})(),nt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,tt,et.A,g.QW,l.ae,it,y.AV]]}),e})()}}]);