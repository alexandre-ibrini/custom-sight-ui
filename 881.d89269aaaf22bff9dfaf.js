"use strict";(self.webpackChunkros_fe_poc=self.webpackChunkros_fe_poc||[]).push([[881],{54881:(k,h,c)=>{c.r(h),c.d(h,{DollyModule:()=>$});var u=c(38583),i=c(23065);const p=(0,i.PH)("[Dolly Detections] Update Detections",(0,i.Ky)()),S=(0,i.PH)("[Dolly Detections] Update Selected Detection",(0,i.Ky)()),m=(0,i.PH)("[Dolly Detections] Update Selected Sub Detection",(0,i.Ky)()),f=(0,i.PH)("[Dolly Detections] Update Selected Detection Detail",(0,i.Ky)()),b=(0,i.PH)("[Dolly Detections] Update Sub Detections",(0,i.Ky)()),g=(0,i.PH)("[Dolly Detections] Update Detection Details",(0,i.Ky)()),v=(0,i.PH)("[Dolly Detections] Update Detection Detail Content",(0,i.Ky)()),O=(0,i.Lq)({loading:!1,detections:[],details:{},detailsContent:"",subDetections:[],selectedDetection:{},selectedSubDetection:{},selectedDetail:""},(0,i.on)(p,(e,s)=>Object.assign(Object.assign({},e),{detections:s.detections})),(0,i.on)(S,(e,s)=>Object.assign(Object.assign({},e),{selectedDetection:s.detection})),(0,i.on)(m,(e,s)=>Object.assign(Object.assign({},e),{selectedSubDetection:s.detection})),(0,i.on)(b,(e,s)=>Object.assign(Object.assign({},e),{subDetections:s.subDetections})),(0,i.on)(g,(e,s)=>Object.assign(Object.assign({},e),{details:s.details})),(0,i.on)(v,(e,s)=>Object.assign(Object.assign({},e),{detailsContent:s.content})),(0,i.on)(f,(e,s)=>Object.assign(Object.assign({},e),{selectedDetail:s.name}))),r=(0,i.Tz)({name:"dollyDetections",reducer:O});var M=c(23815),L=c(36363),y=c(27621);const K=(0,i.P1)(r.selectDetections,e=>e),w=(0,i.P1)(r.selectSubDetections,e=>e),H=(0,i.P1)(r.selectSelectedSubDetection,e=>e),R=(0,i.P1)(r.selectSelectedDetail,e=>e),U=(0,i.P1)(r.selectSelectedDetection,e=>e),z=(0,i.P1)(r.selectDetails,e=>e),B=(0,i.P1)(r.selectDetailsContent,e=>e);var n=c(37716),G=c(67736),I=c(70992),C=c(91451);let E=(()=>{class e{constructor(t,o,D,d){this.linkService=t,this.store=o,this.responseMS=D,this.apiService=d,this.responseMS.get_dolly_detections.subscribe(l=>{var a;this.receiveDetections(null===(a=null==l?void 0:l.data)||void 0===a?void 0:a.detection)}),this.responseMS.get_dolly_detection.subscribe(l=>{var a;this.receiveDetectionDetails(L.o.fromDetectionDetailsToDetectionDetailsViewModel(null===(a=null==l?void 0:l.data)||void 0===a?void 0:a.detection))}),this.responseMS.get_dolly_sub_detections.subscribe(l=>{var a;this.receiveSubDetections(class{static fromSubDetectionsToSubDetectionsViewModel(s){return s.map(t=>({name:t.name.split("/")[1],success:t.success}))}}.fromSubDetectionsToSubDetectionsViewModel(null===(a=null==l?void 0:l.data)||void 0===a?void 0:a.detection))}),this.selectedDetection.subscribe(l=>this._selectedDetection=l),this.selectedSubDetection.subscribe(l=>this._selectedSubDetection=l)}get detections(){return this.store.select(K)}get subDetections(){return this.store.select(w)}get detectionDetails(){return this.store.select(z)}get detectionDetailsContent(){return this.store.select(B)}get selectedDetection(){return this.store.select(U)}get selectedSubDetection(){return this.store.select(H)}get selectedDetail(){return this.store.select(R)}fetchDetections(){let t=(0,M.cloneDeep)(y.u);t.type="get_dolly_detections",this.linkService.sendMessage(t)}fetchSubDetections(t){if(t){let o=(0,M.cloneDeep)(y.u);o.type="get_dolly_sub_detections",o.data.detection_name=t,this.linkService.sendMessage(o)}}fetchDetectionDetails(){let t=y.P;t.data.detection_name=[this._selectedDetection.name,this._selectedSubDetection.name].join("/"),t.type="get_dolly_detection",this.linkService.sendMessage(t)}fetchDetectionDetailsContent(t){this.apiService.fetchDetailContent(t).subscribe(o=>{o&&this.receiveDetectionDetailsContent(JSON.stringify(o))}),this.updateSelectedDetail(t)}updateSelectedDetection(t){this.store.dispatch(S({detection:t}))}updateSelectedDetail(t){this.store.dispatch(f({name:t}))}updateSelectedSubDetection(t){this.store.dispatch(m({detection:t}))}receiveDetections(t){t.sort((o,D)=>o.name>D.name?-1:1),this.store.dispatch(p({detections:t}))}receiveSubDetections(t){t.sort((o,D)=>o.name>D.name?-1:1),this.store.dispatch(b({subDetections:t}))}receiveDetectionDetails(t){this.store.dispatch(g({details:t}))}receiveDetectionDetailsContent(t){this.store.dispatch(v({content:t}))}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(G.X),n.LFG(i.yh),n.LFG(I.B),n.LFG(C.J))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),V=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[E,C.J],imports:[[u.ez,i.Aw.forFeature(r)]]}),e})();var Y=c(61253),P=c(95987),_=c(28049),X=c(71013),N=c(80691);const Q=[{path:"",component:(()=>{class e{constructor(t,o){this.dollyDetectionsMS=t,this.logsMS=o,this.dollyDetectionsPrefix="dolly_detections"}ngOnInit(){this.fetchDetections()}fetchDetectionDetailsContent(t){this.dollyDetectionsMS.fetchDetectionDetailsContent(t)}fetchDetectionDetails(){this.dollyDetectionsMS.fetchDetectionDetails()}fetchDetections(){this.dollyDetectionsMS.fetchDetections()}fetchSubDetections(t){this.dollyDetectionsMS.fetchSubDetections(t)}selectedDetectionChange(t){this.dollyDetectionsMS.updateSelectedDetection(t),this.fetchSubDetections(null==t?void 0:t.name)}selectedSubDetectionChange(t){this.dollyDetectionsMS.updateSelectedSubDetection(t),this.fetchDetectionDetails()}onDownloadDetectionPressed(t){this.dollyDetectionsMS.selectedDetection.pipe((0,_.P)()).subscribe(o=>{this.dollyDetectionsMS.selectedSubDetection.pipe((0,_.P)()).subscribe(D=>{if(D){let d=[this.dollyDetectionsPrefix,o.name].join("/");this.logsMS.downloadLogs([d])}})})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(E),n.Y36(X.T))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-dolly"]],decls:9,vars:21,consts:[[1,"outer-div-padding"],[3,"detectionsList","subDetections","detectionDetailsContent","detectionDetails","selectedDetection","selectedSubDetection","selectedDetail","fetchDetectionDetailsContentEmitter","fetchDetectionDetailsEmitter","fetchDetectionsEmitter","fetchSubDetectionsEmitter","selectedDetectionChangeEmitter","selectedSubDetectionChangeEmitter","downloadDetectionPressedEmitter"]],template:function(t,o){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"app-detections-manager",1),n.NdJ("fetchDetectionDetailsContentEmitter",function(d){return o.fetchDetectionDetailsContent(d)})("fetchDetectionDetailsEmitter",function(){return o.fetchDetectionDetails()})("fetchDetectionsEmitter",function(){return o.fetchDetections()})("fetchSubDetectionsEmitter",function(d){return o.fetchSubDetections(d)})("selectedDetectionChangeEmitter",function(d){return o.selectedDetectionChange(d)})("selectedSubDetectionChangeEmitter",function(d){return o.selectedSubDetectionChange(d)})("downloadDetectionPressedEmitter",function(d){return o.onDownloadDetectionPressed(d)}),n.ALo(2,"async"),n.ALo(3,"async"),n.ALo(4,"async"),n.ALo(5,"async"),n.ALo(6,"async"),n.ALo(7,"async"),n.ALo(8,"async"),n.qZA(),n.qZA()),2&t&&(n.xp6(1),n.Q6J("detectionsList",n.lcZ(2,7,null==o.dollyDetectionsMS?null:o.dollyDetectionsMS.detections))("subDetections",n.lcZ(3,9,null==o.dollyDetectionsMS?null:o.dollyDetectionsMS.subDetections))("detectionDetailsContent",n.lcZ(4,11,null==o.dollyDetectionsMS?null:o.dollyDetectionsMS.detectionDetailsContent))("detectionDetails",n.lcZ(5,13,null==o.dollyDetectionsMS?null:o.dollyDetectionsMS.detectionDetails))("selectedDetection",n.lcZ(6,15,null==o.dollyDetectionsMS?null:o.dollyDetectionsMS.selectedDetection))("selectedSubDetection",n.lcZ(7,17,o.dollyDetectionsMS.selectedSubDetection))("selectedDetail",n.lcZ(8,19,o.dollyDetectionsMS.selectedDetail)))},directives:[N.a],pipes:[u.Ov],styles:[""]}),e})()},{path:"**",redirectTo:""}];let W=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[P.Bz.forChild(Q)],P.Bz]}),e})(),$=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[u.ez,W,V,Y.J]]}),e})()}}]);