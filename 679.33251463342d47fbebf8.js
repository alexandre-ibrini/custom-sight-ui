"use strict";(self.webpackChunkros_fe_poc=self.webpackChunkros_fe_poc||[]).push([[679],{86679:(ee,h,r)=>{r.r(h),r.d(h,{QueueTabModule:()=>k});var M=r(38583),g=r(95987),v=r(19083),n=r(37716),p=r(23065);const S=(0,p.PH)("[Missions] Update Mission Steps",(0,p.Ky)());var y=r(23815);const B=(0,p.Lq)({loading:!1,steps:[]},(0,p.on)(S,(s,u)=>{let e=(0,y.cloneDeep)(s);return e.steps=u.steps,e})),Q=(0,p.Tz)({name:"missionSteps",reducer:B}),K=(0,p.P1)(Q.selectSteps,s=>s),T=(0,p.PH)("[Missions] Update Mission Queue",(0,p.Ky)()),I=(0,p.Lq)({loading:!1,queue:[]},(0,p.on)(T,(s,u)=>{let e=(0,y.cloneDeep)(s);return e.queue=u.queue,e})),C=(0,p.Tz)({name:"missionQueue",reducer:I}),P=(0,p.P1)(C.selectQueue,s=>s);class D{static fromSopToArrayMissionSteps(u){let e=[],t=[];return u.d.forEach(i=>{let o=i;for(;"sop"===o.t;)o=o.d[0];t.push(o)}),t.forEach((i,o)=>{0!==o&&e.push({id:i.l[0],stepName:i.l[1],payload:i.l[2],userData:i.l[3]})}),e}}class R{static fromSopToArrayMissionQueue(u){let e=[],t=[];return u.d.forEach(i=>{let o=i;for(;"sop"===o.t;)o=o.d[0];t.push(o)}),t.forEach((i,o)=>{0!==o&&e.push({order:i.l[0],id:i.l[1],stepCount:i.l[2]})}),e}}var V=r(93898),z=r(70992);let A=(()=>{class s{constructor(e,t,i){this.store=e,this.channelsMW=t,this.responseMS=i,this.responseMS.missionSteps.subscribe(o=>{o&&this.receiveMissionSteps(o)}),this.responseMS.missionQueue.subscribe(o=>{o&&this.receiveMissionQueue(o)})}get missionSteps(){return this.store.select(K)}get missionQueue(){return this.store.select(P)}receiveMissionSteps(e){let t=D.fromSopToArrayMissionSteps(e);this.store.dispatch(S({steps:t}))}receiveMissionQueue(e){let t=R.fromSopToArrayMissionQueue(e);this.store.dispatch(T({queue:t}))}toggleMissionSteps(e){this.channelsMW.toggleChannel("MissionSteps",e)}toggleMissionQueue(e){this.channelsMW.toggleChannel("MissionQueue",e)}}return s.\u0275fac=function(e){return new(e||s)(n.LFG(p.yh),n.LFG(V.$),n.LFG(z.B))},s.\u0275prov=n.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var E=r(77093),O=r(65424);const U=["missionStepsTable"];let x=(()=>{class s{constructor(){this.tableData=[],this.columnsMissionSteps=[{id:"payload",name:"Payload",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>this.getObjectKeyValuePairs(e),badgeBackgroundColorRule:e=>"transparent"}},{id:"stepName",name:"Step Name",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>e,badgeBackgroundColorRule:e=>"transparent"}},{id:"userData",name:"User Data",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>this.getObjectKeyValuePairs(e),badgeBackgroundColorRule:e=>"transparent"}},{id:"id",name:"Id"}],this.getDisplayType=e=>"number"==typeof e?"number":"text"}ngOnInit(){}getObjectKeyValuePairs(e){let t=[],i=null;return e&&(i=JSON.parse(e)),i&&(t=this.getChildrenRecursive(i)),t}getChildrenRecursive(e,t){var i;let a,o=[],d=1;t?o=t.split("."):a="1";let l=this.getObjectKeys(e);if((null==l?void 0:l.length)<=0)return[];let f,c=[];for(let m of l){a=null==o?void 0:o.concat(d.toString()).join(".");let b=(null===(i=this.getObjectKeys(e[m]))||void 0===i?void 0:i.length)>0&&"string"!=typeof e[m],_=b&&Array.isArray(e[m]);f={id:a,parentId:t,name:m,children:b?this.getChildrenRecursive(e[m],a):null,value:b?null:e[m],isArray:_,displayType:b?null:this.getDisplayType(e[m])},c.push(f),d++}return c}getObjectKeys(e){if(e){let t=[];for(const i in e)t.push(i);return t}}ngOnDestroy(){}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-mission-steps-table"]],viewQuery:function(e,t){if(1&e&&n.Gf(U,5),2&e){let i;n.iGM(i=n.CRH())&&(t.missionStepsTable=i.first)}},decls:2,vars:4,consts:[[3,"title","columns","ELEMENT_DATA","areColumnsExpandable"],["missionStepsTable",""]],template:function(e,t){1&e&&n._UZ(0,"app-data-table",0,1),2&e&&n.Q6J("title","Mission steps")("columns",t.columnsMissionSteps)("ELEMENT_DATA",t.tableData)("areColumnsExpandable",!1)},directives:[O.Q],styles:[""]}),s})();const H=["missionQueueTable"];let J=(()=>{class s{constructor(){this.tableData=[],this.columnsMissionQueue=[{id:"order",name:"Order",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>e,badgeBackgroundColorRule:e=>"transparent"}},{id:"stepCount",name:"Step Count",badge:{badgeCell:!0,badgeColorRule:e=>"#425466",badgeValueRule:e=>e,badgeBackgroundColorRule:e=>"transparent"}},{id:"id",name:"Id"}]}ngOnInit(){}ngOnDestroy(){}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-mission-queue-table"]],viewQuery:function(e,t){if(1&e&&n.Gf(H,5),2&e){let i;n.iGM(i=n.CRH())&&(t.missionQueueTable=i.first)}},decls:2,vars:3,consts:[[3,"title","columns","ELEMENT_DATA"],["missionQueueTable",""]],template:function(e,t){1&e&&n._UZ(0,"app-data-table",0,1),2&e&&n.Q6J("title","Mission queue")("columns",t.columnsMissionQueue)("ELEMENT_DATA",t.tableData)},directives:[O.Q],styles:[""]}),s})();const Z=["missionQueue"],w=["missionSteps"],j=[{path:"",component:(()=>{class s{constructor(e){this.missionMS=e,this.subscriptions=[]}ngOnInit(){this.missionMS.toggleMissionQueue(!0),this.missionMS.toggleMissionSteps(!0)}ngAfterViewInit(){this.subscriptions.push(this.missionMS.missionQueue.subscribe(e=>{var t,i,o,a,d;let l=e.map((c,f)=>({id:c.id,order:c.order,stepCount:c.stepCount}));(0,v.diff)(null===(t=this.missionQueue)||void 0===t?void 0:t.tableData,l)&&((null===(i=this.missionQueue)||void 0===i?void 0:i.tableData)&&(this.missionQueue.tableData=l),null===(a=null===(o=this.missionQueue)||void 0===o?void 0:o.missionQueueTable)||void 0===a||a.setTableData(null===(d=this.missionQueue)||void 0===d?void 0:d.tableData))}),this.missionMS.missionSteps.subscribe(e=>{var t,i,o,a;let d=e.map((l,c)=>({id:l.id,payload:l.payload,stepName:l.stepName,userData:l.userData}));(0,v.diff)(null===(t=this.missionSteps)||void 0===t?void 0:t.tableData,d)&&(this.missionSteps&&(this.missionSteps.tableData=d),null===(o=null===(i=this.missionSteps)||void 0===i?void 0:i.missionStepsTable)||void 0===o||o.setTableData(null===(a=this.missionSteps)||void 0===a?void 0:a.tableData))}))}ngOnDestroy(){this.missionMS.toggleMissionSteps(!1),this.missionMS.toggleMissionQueue(!1),this.subscriptions.forEach(e=>e.unsubscribe())}}return s.\u0275fac=function(e){return new(e||s)(n.Y36(A))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-queue-tab"]],viewQuery:function(e,t){if(1&e&&(n.Gf(Z,5),n.Gf(w,5)),2&e){let i;n.iGM(i=n.CRH())&&(t.missionQueue=i.first),n.iGM(i=n.CRH())&&(t.missionSteps=i.first)}},decls:5,vars:0,consts:[["fxLayout","column","fxLayoutGap","16px",1,"outer-div-padding",2,"height","100%","color","black","overflow","auto"],["missionSteps",""],["missionQueue",""]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n._UZ(1,"app-mission-steps-table",null,1),n._UZ(3,"app-mission-queue-table",null,2),n.qZA())},directives:[E.xw,E.SQ,x,J],styles:[""]}),s})()},{path:"**",redirectTo:""}];let W=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[[g.Bz.forChild(j)],g.Bz]}),s})();var X=r(69904),q=r(22685),Y=r(27909);let $=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({providers:[D,R,A],imports:[[M.ez,p.Aw.forFeature(Q),p.Aw.forFeature(C)]]}),s})(),k=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[[M.ez,W,X.A,q.t,Y.o9,$]]}),s})()}}]);