"use strict";(self.webpackChunkros_fe_poc=self.webpackChunkros_fe_poc||[]).push([[547],{3547:(Ne,x,d)=>{d.r(x),d.d(x,{PersistentParamsModule:()=>Me});var D=d(5939),_=d(6983),g=d(8583),M=d(6215),E=d(5917),J=d(3190),V=d(4395),f=d(3815),t=d(7716);const I={type:"get_persistent_params",data:{}},Q={type:"set_persistent_params",data:{}};var u=d(3065);const C=(0,u.PH)("[PersistentParams] Update PersistentParamsMetadata",(0,u.Ky)()),G=(0,u.Lq)({loading:!1,metadata:null},(0,u.on)(C,(n,l)=>Object.assign(Object.assign({},n),{metadata:l.metadata}))),N=(0,u.Tz)({name:"persistentParamsMetadata",reducer:G}),R=(0,u.P1)(N.selectMetadata,n=>n),Z=(0,u.PH)("[PersistentParams] Update PersistentParams",(0,u.Ky)()),U=(0,u.Lq)({loading:!1,persistentParams:null},(0,u.on)(Z,(n,l)=>Object.assign(Object.assign({},n),{persistentParams:l.persistentParams}))),b=(0,u.Tz)({name:"persistentParams",reducer:U}),Y=(0,u.P1)(b.selectPersistentParams,n=>n);let A=(()=>{class n{constructor(){this.getDisplayType=e=>"number"==typeof e?"number":"boolean"==typeof e?"boolean":"text"}mapFromDtoToViewModel(e){return this.getChildrenRecursive(e)}getChildrenRecursive(e,a){var i;let s,r=[],o=1;a?r=a.split("."):s="1";let c=this.getObjectKeys(e);if((null==c?void 0:c.length)<=0)return[];let P,p=[];for(let v of c){s=null==r?void 0:r.concat(o.toString()).join(".");let y=(null===(i=this.getObjectKeys(e[v]))||void 0===i?void 0:i.length)>0&&"string"!=typeof e[v],Ce=y&&Array.isArray(e[v]);P={id:s,parentId:a,name:v,children:y?this.getChildrenRecursive(e[v],s):null,value:y?null:e[v],isArray:Ce,displayType:y?null:this.getDisplayType(e[v]),options:null},p.push(P),o++}return p}getObjectKeys(e){if(e){let a=[];for(const i in e)a.push(i);return a}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var z=d(992),q=d(7736);let w=(()=>{class n{constructor(e,a,i,r){this.store=e,this.mapper=a,this.responseMS=i,this.linkService=r,this.responseMS.get_persistent_params.subscribe(s=>{var o;this.receivePersistentParamsMetadata(null===(o=null==s?void 0:s.data)||void 0===o?void 0:o.metadata),this.receivePersistentParams(null==s?void 0:s.data.preserved_params)}),this.responseMS.set_persistent_params.subscribe(s=>{console.log(null==s?void 0:s.data)})}get PersistentParams(){return this.store.select(Y)}get persistentParamsMetadata(){return this.store.select(R)}requestPersistentParams(){let e=(0,f.cloneDeep)(I);this.linkService.sendMessage(e)}receivePersistentParams(e){let a=this.mapper.mapFromDtoToViewModel(e);this.store.dispatch(Z({persistentParams:a}))}receivePersistentParamsMetadata(e){this.store.dispatch(C({metadata:e}))}setPersistentParams(e){let a=(0,f.cloneDeep)(Q);a.data=e,console.log(a),this.linkService.sendMessage(a)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(u.yh),t.LFG(A),t.LFG(z.B),t.LFG(q.X))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var m=d(7093),S=d(8295),O=d(9983),h=d(3679),F=d(1095),T=d(1295),$=d(7728),X=d(7441),W=d(2458),k=d(7539);const j=["tree"];function ee(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",13),t.TgZ(1,"input",14),t.NdJ("ngModelChange",function(i){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw(2).ngModelChanged(r,i)}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("type",e.data.displayType)("ngModel",e.data.value)}}function te(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-option",17),t._uU(2),t.qZA(),t.BQk()),2&n){const e=l.$implicit;t.xp6(1),t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function ae(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",13),t.TgZ(1,"mat-select",15),t.NdJ("valueChange",function(i){return t.CHM(e),t.oxw(3).$implicit.data.value=i})("valueChange",function(i){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw(2).ngModelChanged(r,i)}),t.YNc(2,te,3,2,"ng-container",16),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("value",e.data.value),t.xp6(1),t.Q6J("ngForOf",e.data.options)}}function ne(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"mat-checkbox",18),t.NdJ("change",function(i){t.CHM(e);const r=t.oxw(3).$implicit;return t.oxw(2).ngModelChanged(r,i.checked)}),t.qZA()}if(2&n){const e=t.oxw(3).$implicit;t.Q6J("checked",e.data.value)}}function ie(n,l){if(1&n&&(t.ynx(0),t.YNc(1,ee,2,2,"mat-form-field",11),t.YNc(2,ae,3,2,"mat-form-field",11),t.YNc(3,ne,1,1,"mat-checkbox",12),t.BQk()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf",!((null==e||null==e.data||null==e.data.options?null:e.data.options.length)>0)&&"boolean"!==e.data.displayType),t.xp6(1),t.Q6J("ngIf",(null==e||null==e.data||null==e.data.options?null:e.data.options.length)>0),t.xp6(1),t.Q6J("ngIf","boolean"===e.data.displayType)}}function se(n,l){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.data.value)}}function re(n,l){if(1&n&&(t.TgZ(0,"div",9),t.YNc(1,ie,4,3,"ng-container",10),t.YNc(2,se,2,1,"span",10),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngIf",e.areValuesEditable),t.xp6(1),t.Q6J("ngIf",!e.areValuesEditable)}}function oe(n,l){if(1&n&&(t.TgZ(0,"div",7),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.YNc(4,re,3,2,"div",8),t.qZA()),2&n){const e=l.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,e.data.name)),t.xp6(2),t.Q6J("ngIf",null!==e.data.value&&(null==e.data||null==e.data.children?null:e.data.children.length)<=0)}}function le(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"tree-root",3,4),t.YNc(4,oe,5,4,"ng-template",null,5,t.W1O),t.qZA(),t.qZA(),t.TgZ(6,"div"),t.TgZ(7,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().submit()}),t._uU(8,"Submit"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("nodes",e.dataSource)("options",e.treeOptions),t.xp6(5),t.Q6J("disabled",!e.changedValues)}}let de=(()=>{class n{constructor(){this.data=new t.IIB,this.areValuesEditable=new t.IIB,this.submitPressed=new t.vpe,this.dataSource=new Array,this.hasChild=(e,a)=>!!a.children&&a.children.length>0,this.treeOptions={animateExpand:!0,displayField:"name",allowDragoverStyling:!1,allowDrag:!1,allowDrop:!1,actionMapping:{mouse:{click:T.iM.TOGGLE_EXPANDED}}},this.searchSubject=new M.X(null)}search(e){var a;this.tree.treeModel.filterNodes(i=>i.data.name.includes(e),!1),null===(a=this.tree.treeModel.getVisibleRoots())||void 0===a||a.forEach(i=>{this.setNodesVisibleRecursive(i)})}setNodesVisibleRecursive(e){var a;e.setIsHidden(!1),null===(a=e.children)||void 0===a||a.forEach(i=>{this.setNodesVisibleRecursive(i)})}setData(e){this.data=e,this.dataSource=(0,f.cloneDeep)(e),this.changedValues=!1}ngModelChanged(e,a){console.log(a),e.data.value="number"===e.data.displayType?Number(a):a,this.onValueChange(e)}ngOnInit(){this.dataSource=(0,f.cloneDeep)(this.data)}onValueChange(e){this.changedValues||(this.changedValues={});let a=this.getNodePathsList(e),i=a[a.length-2].isArray,r=i?a[a.length-2].id:null,s=i?Number(a[a.length-1].name):null,o=e.data.value;console.log(o),this.setNestedKeys(this.changedValues,a,o,r,s)}setNestedKeys(e,a,i,r,s){r&&s>=0&&a.splice(a.length-1,1),a.forEach((o,c)=>{if(r&&s>=0)c===a.length-1?(e[o.name]||(e[o.name]=this.findArrayValues(r)),e[o.name][s]=i):e[o.name]||(e[o.name]=e[o.name]?e[o.name]:{});else if(c===a.length-1)e[o.name]=$.b.isNullOrUndefined(i)?e[o.name]:i;else if(e[o.name])e[o.name]=e[o.name];else if(o.isArray){e[o.name]=[];let p=this.getMidObjectArrayValues(o.id);e[o.name].push(...p),a[c+1]=Number(a[c+1])}else e[o.name]={};e=e[o.name]})}getMidObjectArrayValues(e){var a;let i=this.getCurrentObjectById(e),r=[];return null===(a=null==i?void 0:i.children)||void 0===a||a.forEach((s,o)=>{var c;r[o]={},null===(c=null==s?void 0:s.children)||void 0===c||c.forEach(p=>{this.getNestedKeysFromDataObject(p,r[o])})}),r}getNestedKeysFromDataObject(e,a){var i;if(e.isArray){let r=[];null===(i=null==e?void 0:e.children)||void 0===i||i.forEach((s,o)=>{var c;s.value?r[o]=s.value:(r[o]={},null===(c=null==s?void 0:s.children)||void 0===c||c.forEach(p=>{this.getNestedKeysFromDataObject(p,r[o])}))}),a||(a={}),a[e.name]=r}else a||(a={}),e.children?e.children.forEach((r,s)=>a[e.name]=this.getNestedKeysFromDataObject(r,a[e.name])):a[e.name]=e.value;return a}getCurrentObjectById(e){var a;let i=e.split("."),r=this.dataSource.find(o=>(null==o?void 0:o.id)===i[0]),s=1;for(;s<i.length;){let o=i.slice(0,s+1).join(".");r=null===(a=null==r?void 0:r.children)||void 0===a?void 0:a.find(c=>(null==c?void 0:c.id)===o),s++}return r}findArrayValues(e){var a;let i=this.getCurrentObjectById(e),r=[];return r=null===(a=null==i?void 0:i.children)||void 0===a?void 0:a.map(s=>null==s?void 0:s.value),r}getObjectNestedPathsList(e){var a,i;let r=[];return r.push([{id:e.id,name:e.name,isArray:e.isArray}]),(null===(a=null==e?void 0:e.children)||void 0===a?void 0:a.length)>0&&(null===(i=null==e?void 0:e.children)||void 0===i||i.forEach((s,o)=>{r.push(this.getObjectNestedPathsList(s))})),r}getNodePathsList(e){var a,i,r;let s=e,o=[];for(;s&&!s.data.virtual;){let c={id:null===(a=s.data)||void 0===a?void 0:a.id,name:null===(i=null==s?void 0:s.data)||void 0===i?void 0:i.name,isArray:null===(r=null==s?void 0:s.data)||void 0===r?void 0:r.isArray};o.splice(0,0,c),s=s.parent}return o}submit(){this.submitPressed.emit(this.changedValues)}reset(){this.dataSource=(0,f.cloneDeep)(this.data),this.changedValues={}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-nested-tree"]],viewQuery:function(e,a){if(1&e&&t.Gf(j,5),2&e){let i;t.iGM(i=t.CRH())&&(a.tree=i.first)}},inputs:{data:"data",areValuesEditable:"areValuesEditable"},outputs:{submitPressed:"submitPressed"},decls:1,vars:1,consts:[["style","height:100%; overflow: auto;","fxLayout","row","class","outerDiv",4,"ngIf"],["fxLayout","row",1,"outerDiv",2,"height","100%","overflow","auto"],["fxFlex",""],[1,"tree",3,"nodes","options"],["tree",""],["treeNodeTemplate",""],["mat-flat-button","","color","accent",3,"disabled","click"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","64px","fxFlexFill","",2,"width","100%"],["fxLayoutGap","16px",4,"ngIf"],["fxLayoutGap","16px"],[4,"ngIf"],["appearance","outline",4,"ngIf"],[3,"checked","change",4,"ngIf"],["appearance","outline"],["matInput","","step","0.1",1,"nodeValue",3,"type","ngModel","ngModelChange"],[3,"value","valueChange"],[4,"ngFor","ngForOf"],[3,"value"],[3,"checked","change"]],template:function(e,a){1&e&&t.YNc(0,le,9,3,"div",0),2&e&&t.Q6J("ngIf",a.dataSource.length>0)},directives:[g.O5,m.xw,m.yH,T.qr,F.lW,m.Wh,m.SQ,m.s9,S.KE,O.Nt,h.Fj,h.JJ,h.On,X.gD,g.sg,W.ey,k.oG],pipes:[g.rS],styles:[".tree[_ngcontent-%COMP%]  .node-content-wrapper-active, .node-content-wrapper.node-content-wrapper-active[_ngcontent-%COMP%]:hover, .node-content-wrapper-active.node-content-wrapper-focused[_ngcontent-%COMP%]{background:transparent!important}.tree[_ngcontent-%COMP%]  .node-content-wrapper-active, .node-content-wrapper-focused[_ngcontent-%COMP%], .node-content-wrapper[_ngcontent-%COMP%]:hover{box-shadow:none!important}.tree[_ngcontent-%COMP%]  .node-content-wrapper-focused{background:transparent!important}.nodeValue[_ngcontent-%COMP%]{color:var(--accent-color)}.outerDiv[_ngcontent-%COMP%]  .mat-select-value-text{color:var(--accent-color)}.outerDiv[_ngcontent-%COMP%]  .mat-form-field-appearance-outline .mat-form-field-infix{padding:.75em 0 .5em}.outerDiv[_ngcontent-%COMP%]  .mat-form-field-wrapper{padding-bottom:0}"]}),n})();var ce=d(8623);const ue=["tree"];function pe(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",13),t.TgZ(1,"app-nested-tree",14,15),t.NdJ("submitPressed",function(i){return t.CHM(e),t.oxw().submitPressed(i)}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("data",e.data)}}function me(n,l){1&n&&(t.TgZ(0,"div",13),t._UZ(1,"app-empty-data"),t.qZA())}const he=[{path:"params",component:(()=>{class n{constructor(e){this.persistentParamsMS=e,this.searchFieldValue="",this.subscriptions=[],this.data=[],this.searchSubject=new M.X(null),this.metadataTable=[]}submitPressed(e){this.persistentParamsMS.setPersistentParams(e)}ngOnInit(){this.subscriptions.push(this.persistentParamsMS.persistentParamsMetadata.subscribe(e=>{this.metadata=e,this.data=this.setDataOptions()}),this.persistentParamsMS.PersistentParams.subscribe(e=>{var a;e&&(this.data=e,this.data=this.setDataOptions(),null===(a=this.tree)||void 0===a||a.setData(this.data))}),this.searchSubject.pipe((0,J.w)(e=>(0,E.of)(e)),(0,V.b)(300)).subscribe(e=>{null!=e&&this.tree.search(e)})),this.persistentParamsMS.requestPersistentParams()}setDataOptions(){var e;let a=(0,f.cloneDeep)(this.data);if(this.metadataTable=[],this.metadata&&a)return this.iterateObjectKeys(this.metadata,a),null===(e=this.metadataTable)||void 0===e||e.forEach(i=>{var r;let s=null===(r=null==i?void 0:i.id)||void 0===r?void 0:r.split("."),o=a.find(c=>c.id===s[0]);null==s||s.forEach((c,p)=>{p>0&&(console.log({currentData:o,index:p,conc:s.slice(0,p+1).join(".")}),o=o.children.find(P=>P.id===s.slice(0,p+1).join(".")),console.log(o))}),console.log(o,i),o&&(o.options=null==i?void 0:i.values),console.log({currentData:o,data:a})}),a}iterateObjectKeys(e,a,i){Object.keys(e).forEach(r=>{console.log(r);let s=null==a?void 0:a.find(o=>o.name===r);"values"!==r?this.iterateObjectKeys(e[r],null==s?void 0:s.children,s):(console.log(i),this.metadataTable.push({id:null==i?void 0:i.id,values:e[r]}))})}reloadParams(){this.persistentParamsMS.requestPersistentParams()}setSearchSubjectNext(e){this.searchSubject.next(e)}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-parameters-tab"]],viewQuery:function(e,a){if(1&e&&t.Gf(ue,5),2&e){let i;t.iGM(i=t.CRH())&&(a.tree=i.first)}},decls:16,vars:4,consts:[[1,"outer-div-padding"],["fxLayout","row wrap","fxLayoutGap","7px",2,"height","100%"],["fxLayout","row",1,"page-components","unselectable","full-width-mobile",2,"min-width","260px","width","100%","height","20%"],["fxFlex","50","fxLayoutGap","8px",1,"search-div"],[2,"width","100%",3,"appearance"],["fxFlexAlign","end",1,"bi","bi-search"],["matInput","","placeholder","Search","type","text",1,"search",3,"ngModel","ngModelChange"],["fxFlex",""],["mat-flat-button","",1,"reload-button",3,"click"],["fxLayoutAlign","center center"],["fxFlexAlign","end",1,"bi","bi-arrow-counterclockwise","icon-reload"],[2,"vertical-align","center"],["class","page-components unselectable full-width-mobile","style"," min-width: 260px; width: 100%; height:100%;",4,"ngIf"],[1,"page-components","unselectable","full-width-mobile",2,"min-width","260px","width","100%","height","100%"],[3,"data","submitPressed"],["tree",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"mat-form-field",4),t._UZ(5,"i",5),t.TgZ(6,"input",6),t.NdJ("ngModelChange",function(r){return a.searchFieldValue=r})("ngModelChange",function(r){return a.setSearchSubjectNext(r)}),t.qZA(),t.qZA(),t.qZA(),t._UZ(7,"div",7),t.TgZ(8,"div"),t.TgZ(9,"button",8),t.NdJ("click",function(){return a.reloadParams()}),t.TgZ(10,"div",9),t._UZ(11,"i",10),t.TgZ(12,"span",11),t._uU(13,"Reload"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(14,pe,3,1,"div",12),t.YNc(15,me,2,0,"div",12),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("appearance","standard"),t.xp6(2),t.Q6J("ngModel",a.searchFieldValue),t.xp6(8),t.Q6J("ngIf",(null==a.data?null:a.data.length)>0),t.xp6(1),t.Q6J("ngIf",0===(null==a.data?null:a.data.length)))},directives:[m.xw,m.SQ,m.yH,S.KE,m.XD,O.Nt,h.Fj,h.JJ,h.On,F.lW,m.Wh,g.O5,de,ce.M],styles:[".reload-button[_ngcontent-%COMP%]{background-color:var(--grey-color);border-radius:20px;font-weight:bold}.icon-reload[_ngcontent-%COMP%]{position:relative;font-size:20px;transform:rotate(320deg)}.search-div[_ngcontent-%COMP%]{height:35px}.search[_ngcontent-%COMP%]{height:100%;width:70%;padding-left:5px}.bi-search[_ngcontent-%COMP%]{font-size:13px;position:relative;top:-2px}  .mat-form-field-underline{display:none}  .mat-form-field-infix{border:0;margin-left:20px;padding:0}"]}),n})()},{path:"**",redirectTo:"params"}];let ve=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[_.Bz.forChild(he)],_.Bz]}),n})();var ge=d(7909);let fe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[w,A],imports:[[g.ez,u.Aw.forFeature(b),u.Aw.forFeature(N)]]}),n})();var _e=d(9904),Pe=d(980),ye=d(4975),Te=d(2674),xe=d(5906);let Me=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.ez,ve,ge.o9,_.Bz.forChild([]),_e.A,_.Bz,D.Nh,Pe.G,T.xc,h.u5,ye.Q,Te.z,fe,xe.E]]}),n})()}}]);